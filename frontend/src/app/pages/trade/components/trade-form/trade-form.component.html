<form [formGroup]="tradeForm">

  <!-- si no existe el contacto se lo busca por cvu o alias -->
  <div *ngIf="formStep == 1 && !tradeFinished" class="flex flex-col max-w-[23.125rem] w-full mx-auto gap-14">
    <label for="cvu-alias" class="flex flex-col gap-3 text-[#3A3A3A]">
      Ingresá el CVU o alias
      <input formControlName="cvuOrAlias" type="text" id="cvu-alias" class="bg-transparent outline-none px-2 py-3 border-b border-[#818181] text-[#818181]" placeholder="CVU o alias">
    </label>
    <button
      (click)="increaseStep()" type="button"
      [disabled]="tradeForm.get('cvuOrAlias')?.invalid"
      [ngClass]="tradeForm.get('cvuOrAlias')?.invalid? 'bg-[#3564FD]/[25%]' : 'bg-[#3564FD] hover:bg-[#0535be]'"
      class="max-w-[17.25rem] w-full mx-auto py-2 rounded-full text-white duration-200">Continuar</button>
  </div>

  <!-- si busqué un usuario se confirma que se encontró -->
  <div *ngIf="formStep == 2 && !tradeFinished" class="text-[#3A3A3A] flex flex-col gap-10 max-w-[23.125rem] w-full mx-auto">
    <ng-container *ngIf="destiny; else elseTemplate">
      <div class="flex flex-col gap-6">
        <p>¿Esta es la cuenta a la que querés transferir?</p>
        <p class="text-lg">{{destiny.name}} {{destiny.lastname}}</p>
        <div class="flex flex-col gap-2 text-sm text-[#818181]">
          <p>Alias: {{destiny.alias}}</p>
          <p>CVU: {{destiny.cvu}}</p>
        </div>
      </div>
      <button (click)="increaseStep()" type="button" class="max-w-[17.25rem] w-full mx-auto py-2 bg-[#3564FD] rounded-full text-white duration-200 hover:bg-[#0535be]">Continuar</button>
    </ng-container>
    <ng-template #elseTemplate>
      <p class="text-center text-xl">No se encontró la cuenta.</p>
      <button (click)="refresh()" type="button" class="max-w-[17.25rem] w-full mx-auto py-2 bg-[#3564FD] rounded-full text-white duration-200 hover:bg-[#0535be]">Volver</button>
    </ng-template>    
  </div>
  
  <!-- si quiero transferir a un contacto se viene al paso 2 a indicar el monto -->
  <div *ngIf="formStep == 3 && !tradeFinished" class="text-[#818181] flex flex-col gap-10 max-w-[23.125rem] w-full mx-auto">
    <div class="flex flex-col gap-4 relative">
      <div class="flex items-center gap-3">
        <p class="text-3xl absolute">$</p>
        <input formControlName="mount" type="number" class="text-5xl w-full text-center outline-none bg-transparent" placeholder="0">
      </div>
      <p *ngIf="tradeForm.get('mount')?.invalid && tradeForm.get('mount')?.dirty" class="text-[#FF7990] font-medium text-center">Monto inválido</p>
      <p class="text-center">En tu Ualá tenés disponibles {{user.balance | currency}}</p>
    </div>
    <button 
      [disabled]="tradeForm.get('mount')?.invalid" [ngClass]="tradeForm.get('mount')?.invalid? 'bg-[#3564FD]/[25%]' : 'bg-[#3564FD] hover:bg-[#0535be]'"
      (click)="increaseStep()" type="button"
      class="max-w-[17.25rem] w-full mx-auto py-2 rounded-full text-white duration-200">
        Continuar
      </button>
  </div>

  <!-- confirmar transferencia -->
  <div *ngIf="formStep == 4 && !tradeFinished" class="text-[#3A3A3A] max-w-[48.875rem] w-full flex flex-col gap-14 mx-auto">
    <div class="grid grid-cols-2 gap-10">
      <div class="flex flex-col gap-4">
        <p class="text-[#818181]">Vas a transferir</p>
        <div class="flex flex-col gap-10">
          <p class="text-3xl font-light">{{tradeForm.getRawValue().mount | currency}}</p>
          <label for="motive" class="flex flex-col gap-3 font-light text-[#818181]">
            Motivo
            <input formControlName="motive" type="text" id="motive"
              class="bg-transparent outline-none px-2 py-3 border-b border-[#818181] text-[#3A3A3A]" placeholder="Varios">
          </label>
        </div>
      </div>
      <div class="flex flex-col gap-4">
        <p class="text-[#818181]">Destino</p>
        <div class="flex flex-col gap-3">
          <p class="text-xl font-semibold">{{destiny.name}} {{destiny.lastname}}</p>
          <p class="text-[#818181]">Alias: {{destiny.alias}}</p>
          <p class="text-[#818181]">CVU: {{destiny.cvu}}</p>
        </div>
      </div>
    </div>
    <div class="flex justify-center">
      <button (click)="submitTrade()"
        type="submit"
        [disabled]="tradeForm.invalid"
        [ngClass]="tradeForm.invalid? 'bg-[#3564FD]/[25%]' : 'bg-[#3564FD] hover:bg-[#0535be]'"
        class="max-w-[17.25rem] w-full mx-auto py-2 rounded-full text-white duration-200">Transferir</button>
    </div>
  </div>

  <!-- pantalla de transferencia confirmada -->
  <div *ngIf="tradeFinished" class="text-[#3A3A3A] max-w-[23.125rem] w-full flex flex-col items-center mx-auto">
    <fa-icon [icon]="faCircleCheck" class="text-7xl text-[#3564FD]"></fa-icon>
    <p class="mt-6 mb-10 text-lg font-light">Su transferencia fue realizada con éxito</p>
    <button (click)="refresh()" class="max-w-[17.25rem] w-full mx-auto py-2 rounded-full text-white duration-200 bg-[#3564FD] hover:bg-[#0535be]">Terminar</button>
  </div>

</form>